# System Overview Diagram

## ğŸ“Š Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLIENT LAYER                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  React Native   â”‚  â”‚   React Web      â”‚  â”‚  Desktop Client â”‚â”‚
â”‚  â”‚   (Mobile)      â”‚  â”‚  (Web Browser)   â”‚  â”‚   (Electron)    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚           â”‚                    â”‚                     â”‚          â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                        â”‚                  â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                  â”‚
                    HTTP â”‚ API Calls        â”‚
                         â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API GATEWAY                                   â”‚
â”‚                    (NestJS App)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        â”‚                  â”‚                      â”‚
â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                      â”‚
â”‚                   â”‚ Input Validation  â”‚   â”‚                      â”‚
â”‚                   â”‚ CORS Check        â”‚   â”‚                      â”‚
â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                      â”‚
â”‚                        â”‚                  â”‚                      â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                      â”‚
â”‚         â”‚                            â”‚   â”‚                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â” â”‚                      â”‚
â”‚    â”‚   Controllers    â”‚  â”‚  Middleware â”‚ â”‚                      â”‚
â”‚    â”‚                  â”‚  â”‚             â”‚ â”‚                      â”‚
â”‚    â”‚ â€¢ Rooms          â”‚  â”‚ â€¢ Error     â”‚ â”‚                      â”‚
â”‚    â”‚ â€¢ Schedule       â”‚  â”‚ â€¢ Validationâ”‚ â”‚                      â”‚
â”‚    â”‚ â€¢ Stats          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                      â”‚
â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚                      â”‚
â”‚         â”‚                                â”‚                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                      â”‚
â”‚    â”‚         Services Layer             â”‚ â”‚                      â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚                      â”‚
â”‚    â”‚                                    â”‚ â”‚                      â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ Excel Parser Service        â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ â€¢ Auto detect columns       â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ â€¢ Parse flexible formats    â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ â€¢ Extract building codes    â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚                      â”‚
â”‚    â”‚                                    â”‚ â”‚                      â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ Schedule Service            â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ â€¢ Import Excel              â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ â€¢ Transaction handling      â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ â€¢ Auto create B/R           â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚                      â”‚
â”‚    â”‚                                    â”‚ â”‚                      â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ Room Availability Service   â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ â€¢ Overlap detection         â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ â€¢ Bitmap algorithm          â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ â€¢ Continuous slots finding  â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â”‚ â€¢ Cache key generation      â”‚  â”‚ â”‚                      â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚                      â”‚
â”‚    â”‚                                    â”‚ â”‚                      â”‚
â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                      â”‚
â”‚         â”‚                                â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚               â”‚
          â”‚         â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
          â”‚         â”‚ Redis Cache   â”‚      â”‚
          â”‚         â”‚  (5 min TTL)  â”‚      â”‚
          â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
          â”‚                                â”‚
          â–¼                                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚PostgreSQL â”‚                    â”‚  Redis   â”‚
    â”‚  Database â”‚                    â”‚  Cache   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ Building  â”‚
    â”‚ Room      â”‚
    â”‚ Schedule  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow: Search Request

```
â”Œâ”€ USER REQUEST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/rooms/available                              â”‚
â”‚ ?thu=3&tiet_bd=4&tiet_kt=6&building=A1&min_continuous=2â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Controller    â”‚
         â”‚ Validation    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ (params validated)
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Generate Cache Key    â”‚
         â”‚ available:3:4:6:A1:2  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Check Redis Cache     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚       â”‚
            HIT  â”‚       â”‚  MISS
                 â”‚       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”    â”‚
         â”‚ Return   â”‚    â”‚
         â”‚ Cached   â”‚    â”‚
         â”‚ Result   â”‚    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Room Availability    â”‚
              â”‚ Service              â”‚
              â”‚                      â”‚
              â”‚ 1. Get all rooms     â”‚
              â”‚    (building filter) â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Get Schedules        â”‚
              â”‚ WHERE thu = 3        â”‚
              â”‚ AND room_id IN (...)  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ For Each Room:       â”‚
              â”‚                      â”‚
              â”‚ 1. Create bitmap     â”‚
              â”‚ 2. Mark occupied     â”‚
              â”‚ 3. Find slots        â”‚
              â”‚ 4. Add to result     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Build Response DTO   â”‚
              â”‚ {                    â”‚
              â”‚  thu: 3,             â”‚
              â”‚  tiet: "4-6",        â”‚
              â”‚  building: "A1",     â”‚
              â”‚  rooms: [...]        â”‚
              â”‚ }                    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Cache in Redis       â”‚
              â”‚ TTL: 300 seconds     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Return Response      â”‚
              â”‚ to Client            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¤ Data Flow: Upload Excel

```
â”Œâ”€ FILE UPLOAD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/schedule/upload                            â”‚
â”‚ Content-Type: multipart/form-data                    â”‚
â”‚ File: schedule.xlsx                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ File Validation   â”‚
         â”‚ â€¢ Extension check â”‚
         â”‚ â€¢ Size check      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Excel Parser Service      â”‚
         â”‚                           â”‚
         â”‚ 1. Read workbook          â”‚
         â”‚ 2. Find header row        â”‚
         â”‚ 3. Parse each data row    â”‚
         â”‚ 4. Validate & convert     â”‚
         â”‚ 5. Return ParsedRow[]     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Schedule Service          â”‚
         â”‚                           â”‚
         â”‚ START TRANSACTION         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 1. Delete old schedules   â”‚
         â”‚    DELETE FROM schedules  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 2. For each parsed row:   â”‚
         â”‚    â€¢ Check building existsâ”‚
         â”‚    â€¢ Create if not        â”‚
         â”‚    â€¢ Check room exists    â”‚
         â”‚    â€¢ Create if not        â”‚
         â”‚    â€¢ Insert schedule      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ COMMIT TRANSACTION        â”‚
         â”‚ (or ROLLBACK on error)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Clear Redis Cache         â”‚
         â”‚ FLUSHDB                   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Return Success Response   â”‚
         â”‚ {                         â”‚
         â”‚  success: true,           â”‚
         â”‚  rows_imported: 150       â”‚
         â”‚ }                         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¬ Algorithm: Find Continuous Empty Slots

```
INPUT:
  tiet_bd = 1, tiet_kt = 10
  schedules = [4->6, 7->9]
  min_continuous = 2

STEP 1: Create Bitmap
  bitmap = [0,0,0,0,0,0,0,0,0,0]  (length = 10)

STEP 2: Mark Occupied
  For schedule 4->6:
    bitmap[3] = 1  (session 4)
    bitmap[4] = 1  (session 5)
    bitmap[5] = 1  (session 6)
  
  For schedule 7->9:
    bitmap[6] = 1  (session 7)
    bitmap[7] = 1  (session 8)
    bitmap[8] = 1  (session 9)
  
  Result: [0,0,0,1,1,1,1,1,1,0]

STEP 3: Find Sequences
  Scan bitmap for consecutive 0s:
    
    Position 0-2: [0,0,0] â†’ 3 consecutive (â‰¥2) âœ“
      â†’ Can start at session 1
    
    Position 9: [0] â†’ 1 consecutive (< 2) âœ—
  
  Result: [1]

STEP 4: Meaning
  Slot 1: Sessions 1,2,3 are all empty (Nâ‰¥2) âœ“
  Slot 10: Only session 10 is empty (N<2) âœ—
```

---

## ğŸ“‹ Excel Parser: Format Flexibility

```
SUPPORTED FORMATS:

Format 1 (Vietnamese):
â”‚ MÃ£ HP    â”‚ Lá»›p      â”‚ PhÃ²ng      â”‚ Thá»© â”‚ Tiáº¿t  â”‚
â”‚ CS101    â”‚ CQ17-01  â”‚ A1-301     â”‚ 2   â”‚ 4->6  â”‚

Format 2 (English):
â”‚ Course Code â”‚ Class â”‚ Room Name â”‚ Day â”‚ Session â”‚
â”‚ CS101       â”‚ CQ17  â”‚ 301       â”‚ 2   â”‚ 4-6     â”‚

Format 3 (Mixed):
â”‚ MÃ£ Há»c Pháº§n â”‚ Lá»›p Há»c Pháº§n â”‚ PhÃ²ng â”‚ Thá»© â”‚ Tiáº¿t â”‚
â”‚ CS101       â”‚ CQ17-01      â”‚ 302A  â”‚ 3   â”‚ 7->9 â”‚

VARIATIONS SUPPORTED:

Day Format:
  âœ“ 2, 3, 4, 5, 6, 7 (numeric)
  âœ“ "Thá»© 2", "Thá»© 3", ... (Vietnamese)
  âœ“ "Monday", "Tuesday", ... (English)
  âœ“ "Mon", "Tue", ... (Short)
  âœ“ "T2", "T3", ... (Abbreviation)

Session Format:
  âœ“ "4->6" (arrow separator)
  âœ“ "4-6" (dash separator)
  âœ“ "4:6" (colon separator)
  âœ“ "4,6" (comma separator)
  âœ“ "4" (single session)

Room/Building:
  âœ“ "A1-301" (building-room)
  âœ“ "301A" (room with letter)
  âœ“ "301" (room only, default building)
```

---

## ğŸ—„ï¸ Database Schema Diagram

```
BUILDINGS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id (UUID) PK                â”‚
â”‚ code (VARCHAR) UNIQUE       â”‚â—„â”€â”€â”€â”€â”
â”‚ name (VARCHAR)              â”‚     â”‚
â”‚ is_active (BOOLEAN)         â”‚     â”‚
â”‚ created_at (TIMESTAMP)      â”‚     â”‚
â”‚ updated_at (TIMESTAMP)      â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
         â”‚                          â”‚
         â”‚ (1 to Many)              â”‚
         â–¼                          â”‚
ROOMS                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ id (UUID) PK                â”‚    â”‚
â”‚ name (VARCHAR)              â”‚    â”‚
â”‚ building_id (UUID) FK       â”œâ”€â”€â”€â”€â”˜
â”‚ is_active (BOOLEAN)         â”‚
â”‚ created_at (TIMESTAMP)      â”‚
â”‚ updated_at (TIMESTAMP)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ (1 to Many)
         â–¼
SCHEDULES
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id (UUID) PK                â”‚
â”‚ room_id (UUID) FK           â”‚
â”‚ thu (INT) 2-7               â”‚
â”‚ tiet_bat_dau (INT)          â”‚
â”‚ tiet_ket_thuc (INT)         â”‚
â”‚ ma_hp (VARCHAR)             â”‚
â”‚ lop (VARCHAR)               â”‚
â”‚ mon_hoc (VARCHAR)           â”‚
â”‚ giang_vien (VARCHAR)        â”‚
â”‚ ngay_bat_dau (DATE)         â”‚
â”‚ ngay_ket_thuc (DATE)        â”‚
â”‚ created_at (TIMESTAMP)      â”‚
â”‚ updated_at (TIMESTAMP)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

INDEXES:
â”œâ”€ UNIQUE buildings.code
â”œâ”€ schedules (room_id, thu)
â””â”€ schedules (thu, tiet_bat_dau, tiet_ket_thuc)
```

---

## âš¡ Performance Timeline

```
WITHOUT CACHE:
  Request 1: â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 150ms
  Request 2: â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 150ms
  Request 3: â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 150ms

WITH CACHE:
  Request 1 (miss): â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 150ms
  Request 2 (hit):  â”                 5ms âœ“
  Request 3 (hit):  â”                 5ms âœ“
  Request 4 (hit):  â”                 5ms âœ“
  ...
  (After 5 min expires)
  Request N (miss): â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 150ms

IMPROVEMENT: 30x faster for cached requests
CACHE HIT RATE: ~85% typical usage
```

---

## ğŸš€ Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            LOAD BALANCER (Nginx)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚           â”‚           â”‚
       â–¼           â–¼           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Node 1  â”‚ â”‚ Node 2  â”‚ â”‚ Node 3  â”‚
   â”‚:3000   â”‚ â”‚:3000   â”‚ â”‚:3000   â”‚
   â”‚(NestJS)â”‚ â”‚(NestJS)â”‚ â”‚(NestJS)â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚          â”‚          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚
        â–¼                     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚PostgreSQL    â”‚      â”‚ Redis    â”‚
   â”‚(Master)      â”‚      â”‚(Primary) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚
        â–¼                     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚PostgreSQL    â”‚      â”‚ Redis    â”‚
   â”‚(Replica)     â”‚      â”‚(Replica) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**See documentation files for more details!**
